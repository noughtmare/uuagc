--marcos: macros extension

optpragmas
{
{-# LANGUAGE DeriveLift #-}
}

imports
{
import CommonTypes
import Language.Haskell.TH.Syntax (Lift)
import LiftOrphans ()
}

DERIVING * : Lift

TYPE MaybeMacro  = MAYBE Macro

DATA Macro     | Macro   con      : {ConstructorIdent}
                         children : MacroChildren
               | None

TYPE MacroChildren = [MacroChild]

DATA MacroChild | RuleChild   name      : {Identifier}
                              macro     : Macro
                | ChildChild  name      : {Identifier}
                              child     : {Identifier}

                | ValueChild  name      : {Identifier}
                              value     : {String}

DERIVING MaybeMacro Macro MacroChildren MacroChild : Show
